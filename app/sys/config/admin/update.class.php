<?php
/*
** 开发者：运城盘石网络科技有限公司
** 网址：http://www.panshi18.com/
** 客服电话：0359-2066616
*/
 goto O050389878345178; O495254196662505: load::sys_class("\x61\x64\x6d\151\x6e\142\x61\163\x65"); goto O026927474612646; O050389878345178: defined("\x49\x4e\137\114\x43\115\123") or exit("\x4e\x6f\x20\160\x65\x72\x6d\151\x73\x73\151\157\x6e"); goto O495254196662505; O026927474612646: class update extends adminbase { public function __construct() { goto O975323753738144; O673089377066587: $this->code = $_L["\143\157\156\x66\x69\147"]["\x61\x64\155\151\x6e"]["\x6f\141\165\x74\150\137\143\157\144\145"]; goto O892528801026413; O892528801026413: $this->vernow = $_L["\143\x6f\x6e\146\151\147"]["\141\x64\155\x69\156"]["\x76\145\162"]; goto O978343872728563; O583424231467225: parent::__construct(); goto O338725609662273; O338725609662273: $this->api = "\x68\x74\164\160\x73\72\x2f\57\141\160\x69\x2e\x70\x61\x6e\x73\150\151\61\x38\56\143\157\155\57\141\160\160\57\x69\156\x64\x65\170\56\160\150\x70\x3f\x74\75\x6f\160\x65\x6e\x26\x6e\75\157\x61\x75\164\x68\46\x63\75"; goto O673089377066587; O975323753738144: global $_L; goto O583424231467225; O978343872728563: } public function doindex() { goto O523305178527155; O523305178527155: global $_L; goto O822589716365839; O822589716365839: switch ($_L["\x66\x6f\x72\x6d"]["\x61\x63\164\x69\x6f\156"]) { default: goto O333598703365317; O281135506737024: $url = $this->api . "\x69\156\144\145\x78\x26\x61\75\x69\156\146\x6f"; goto O433282779350282; O433282779350282: $result = json_decode(http::post($url, ["\x64\157\x6d\x61\151\x6e" => HTTP_HOST, "\x70\157\162\164" => HTTP_PORT, "\143\x6f\x64\x65" => $this->code]), true); goto O476579103065135; O476579103065135: $info = $result["\x64\141\164\x61"]["\157\141\x75\x74\x68"]; goto O401910423186438; O175094816359162: goto O293346974631905; goto O052161020178586; O545419058931306: require LCMS::template("\x6f\x77\156\57\165\160\x64\x61\164\x65"); goto O175094816359162; O333598703365317: $config = $_L["\143\157\156\146\x69\147"]["\141\x64\155\151\156"]; goto O281135506737024; O401910423186438: $buyurl = $this->api . "\142\x75\171\x26\144\157\155\x61\x69\x6e\x3d" . HTTP_HOST; goto O545419058931306; O052161020178586: } goto O296179521412451; O822115274701619: O293346974631905: goto O505996325369206; O296179521412451: O972824322365362: goto O822115274701619; O505996325369206: } public function docloud() { goto O704965710381667; O222167381622645: switch ($_L["\146\x6f\162\155"]["\141\x63\x74\x69\x6f\156"]) { case "\143\x68\x65\143\x6b\x5f\166\145\162": goto O413506239145607; O887392051411619: goto O165704432575447; goto O311572863415585; O436024460817879: goto O658971588717693; goto O444830140767843; O609644451715804: ajaxout(1, "\163\165\143\143\x65\x73\x73", '', $result["\x64\141\164\x61"]); goto O859539298885176; O929059546107060: ajaxout(0, $result["\x6d\x73\147"]); goto O436024460817879; O859539298885176: O658971588717693: goto O887392051411619; O963125040293394: $result = json_decode(http::post($url, ["\141\x63\164\151\x6f\x6e" => "\144\x65\146\x61\165\154\x74", "\x64\x6f\x6d\x61\x69\156" => HTTP_HOST, "\143\x6f\x64\145" => $this->code, "\166\x65\x72" => $this->vernow]), true); goto O323238255355285; O323238255355285: if ($result["\x63\157\144\x65"] == "\x31") { goto O217850340480372; } goto O929059546107060; O444830140767843: O217850340480372: goto O609644451715804; O413506239145607: $url = $this->api . "\151\x6e\x64\x65\x78\46\x61\75\x76\x65\162"; goto O963125040293394; O311572863415585: case "\163\x68\x6f\x77\x5f\x76\145\162": goto O707769669223584; O707769669223584: $url = $this->api . "\151\156\x64\145\x78\46\x61\75\x76\145\x72"; goto O624491748518712; O379901730686511: goto O165704432575447; goto O493271998394851; O464250499466247: if ($result["\143\x6f\144\145"] == "\61") { goto O266899838954087; } goto O285985410913910; O624491748518712: $result = json_decode(http::post($url, ["\141\143\x74\x69\157\x6e" => "\163\x68\157\x77", "\x64\157\x6d\141\x69\156" => HTTP_HOST, "\143\157\x64\x65" => $this->code, "\166\x65\162" => $this->vernow]), true); goto O464250499466247; O252327005625489: goto O910215220698171; goto O881505312995463; O881505312995463: O266899838954087: goto O985232327807130; O285985410913910: ajaxout(0, $result["\x6d\163\x67"]); goto O252327005625489; O985232327807130: ajaxout(1, "\x73\x75\x63\143\x65\163\163", '', $result["\144\141\x74\x61"]); goto O970414609923214; O970414609923214: O910215220698171: goto O379901730686511; O493271998394851: case "\x67\x65\x74\x5f\x66\151\154\145\x73": goto O427164779457867; O828190824472497: if ($result["\143\x6f\x64\x65"] == "\61") { goto O025070346683648; } goto O692046575015347; O571190751759579: goto O758200486318816; goto O713031239826737; O918756631954099: goto O165704432575447; goto O446308672595702; O427164779457867: $url = $this->api . "\151\156\144\x65\170\46\x61\75\146\151\x6c\145"; goto O988265913487797; O373529314718258: ajaxout(1, "\x73\165\143\145\x73\x73", '', ["\x63\x6f\165\x6e\164" => count($files), "\x66\x69\x6c\x65\x73" => $files]); goto O544066385818692; O692046575015347: ajaxout(0, $result["\155\163\147"]); goto O571190751759579; O560964330647170: $files = $this->files_check($this->decode($result["\144\141\x74\x61"]["\146\x69\154\x65\x73"], "\152\x73\157\x6e")); goto O373529314718258; O544066385818692: O758200486318816: goto O918756631954099; O713031239826737: O025070346683648: goto O560964330647170; O988265913487797: $result = json_decode(http::post($url, ["\x61\x63\164\151\157\156" => "\x6c\151\163\x74", "\144\157\x6d\x61\151\x6e" => HTTP_HOST, "\x63\157\144\145" => $this->code, "\x76\145\x72" => $_L["\146\x6f\x72\155"]["\x76\145\162"]]), true); goto O828190824472497; O446308672595702: case "\144\157\x77\x6e\x5f\146\x69\154\145": goto O150824319917513; O227875841247740: O909747875362869: goto O382586306342102; O033854724462352: makedir($path . str_replace(strrchr($_L["\146\x6f\162\155"]["\146\x69\154\145\x6e\141\x6d\145"], "\57"), '', $_L["\x66\157\162\x6d"]["\146\x69\x6c\x65\x6e\x61\x6d\x65"])); goto O419689405685837; O866923374574018: O648337836082796: goto O805424817452732; O032108301807630: $result = json_decode(http::post($url, ["\x61\143\x74\x69\x6f\x6e" => "\144\x6f\167\156", "\144\x6f\155\141\x69\156" => HTTP_HOST, "\x63\x6f\x64\x65" => $this->code, "\x66\x69\x6c\145\x6e\141\x6d\145" => base64_encode($_L["\x66\157\x72\155"]["\146\151\154\x65\x6e\141\155\145"])]), true); goto O612753238926218; O382586306342102: goto O165704432575447; goto O187878402453664; O829247157458362: O480632824336888: goto O032752076361125; O032752076361125: ajaxout(1, "\x73\165\143\145\163\163"); goto O227875841247740; O635850658612657: if (!$_L["\146\x6f\162\x6d"]["\x76\145\162"]) { goto O480632824336888; } goto O643839006544076; O863231442169190: goto O909747875362869; goto O866923374574018; O150824319917513: $url = $this->api . "\x69\x6e\144\x65\170\46\x61\x3d\146\151\x6c\x65"; goto O032108301807630; O419689405685837: file_put_contents($path . $_L["\146\157\162\155"]["\x66\x69\x6c\145\156\x61\x6d\145"], $content); goto O829247157458362; O213225820912418: ajaxout(0, $result["\x6d\163\147"]); goto O863231442169190; O805424817452732: $content = $this->decode($result["\x64\x61\x74\x61"]); goto O635850658612657; O643839006544076: $path = PATH_CACHE . "\x75\160\x64\141\164\145\x2f{$_L["\146\x6f\162\x6d"]["\166\x65\x72"]}\57"; goto O033854724462352; O612753238926218: if ($result["\x63\157\x64\145"] == "\61") { goto O648337836082796; } goto O213225820912418; O187878402453664: case "\143\157\160\x79\137\146\x69\x6c\x65\163": goto O792078958200501; O723916654599705: goto O165704432575447; goto O970522948759692; O144830385967037: if (!copydir($path, PATH_WEB)) { goto O719626491809913; } goto O001536864646646; O001357355891831: O599898978978041: goto O723916654599705; O294273763956174: ajaxout(1, "\x73\165\x63\143\145\x73\163"); goto O001357355891831; O792078958200501: if ($_L["\146\x6f\162\x6d"]["\166\145\162"]) { goto O609993825919974; } goto O250253819823984; O722346090470264: $path = PATH_CACHE . "\x75\x70\144\141\x74\x65\x2f{$_L["\146\157\x72\155"]["\166\145\162"]}\x2f"; goto O144830385967037; O583818687216563: O719626491809913: goto O294273763956174; O761874945078511: goto O599898978978041; goto O036613406299015; O036613406299015: O609993825919974: goto O722346090470264; O250253819823984: ajaxout(0, "\145\162\x72\x6f\x72"); goto O761874945078511; O001536864646646: deldir($path); goto O583818687216563; O970522948759692: case "\x67\145\164\x5f\x64\x61\164\x61": goto O982527718518974; O844574537585962: $sqldata = $this->decode($result["\x64\141\164\x61"]["\x73\x71\154\x64\x61\164\141"]); goto O490047834482236; O921295997854840: O686344392915833: goto O094856870376507; O345903199311745: $result = json_decode(http::post($url, ["\144\x6f\155\x61\x69\x6e" => HTTP_HOST, "\x63\157\x64\x65" => $this->code, "\166\145\162" => $this->vernow]), true); goto O989703311988922; O044824325857873: ajaxout(1, "\x73\x75\143\143\145\x73\163"); goto O355275494035312; O982527718518974: $url = $this->api . "\151\156\x64\x65\170\x26\x61\75\144\141\x74\x61"; goto O345903199311745; O355275494035312: goto O165704432575447; goto O435619221343423; O386063021704301: $this->updatesql($sqldata); goto O921295997854840; O490047834482236: $sqldata = str_replace("\133\x54\x41\x42\x4c\105\137\120\x52\x45\x5d", $_L["\x6d\171\163\161\154"]["\x70\x72\x65"], $sqldata); goto O386063021704301; O094856870376507: $this->updatever($_L["\146\x6f\x72\155"]["\x76\x65\162"]); goto O044824325857873; O989703311988922: if (!($result["\143\x6f\x64\145"] == "\61")) { goto O686344392915833; } goto O844574537585962; O435619221343423: } goto O987492849149995; O147509199717701: O165704432575447: goto O023127541226358; O987492849149995: O222274015487262: goto O147509199717701; O704965710381667: global $_L; goto O222167381622645; O023127541226358: } private function files_check($cloudfiles) { goto O964676134229561; O082522687499420: foreach ($cloudfiles as $sign => $file) { goto O872201625479813; O892762764114269: O139525859331236: goto O130176546944509; O872201625479813: if ($locfiles[$sign] && $locfiles[$sign]["\x70\x61\x74\150"] == $file["\160\141\164\150"] && $locfiles[$sign]["\163\x68\141\61"] != $file["\x73\x68\x61\61"]) { goto O633455922154838; } goto O967647963045185; O474109020493655: O633455922154838: goto O468511274561027; O451630409879817: O867323973504501: goto O655330417885420; O967647963045185: if (!$locfiles[$sign]) { goto O867323973504501; } goto O923211754249229; O468511274561027: $files[] = $file; goto O079186343640743; O350249516253224: O690438089210164: goto O892762764114269; O079186343640743: goto O690438089210164; goto O451630409879817; O923211754249229: goto O690438089210164; goto O474109020493655; O655330417885420: $files[] = $file; goto O350249516253224; O130176546944509: } goto O545318018654256; O799195675517763: $locfiles = $this->getfiles(); goto O082522687499420; O545318018654256: O644685906480353: goto O908779823642004; O908779823642004: return $files; goto O959727172133447; O964676134229561: global $_L; goto O799195675517763; O959727172133447: } private function decode($string, $type = '') { goto O155359752789823; O791154512505103: O683395165073842: goto O407548535339709; O508624735001650: $result = json_decode($string, true); goto O791154512505103; O155359752789823: global $_L; goto O820106659452539; O407548535339709: return $result; goto O702032092570664; O070586734576018: if ($type == "\x6a\163\157\x6e") { goto O980127858223903; } goto O416647104189759; O820106659452539: $string = gzinflate(base64_decode($string)); goto O070586734576018; O513386668410650: goto O683395165073842; goto O417805764049091; O416647104189759: $result = $string; goto O513386668410650; O417805764049091: O980127858223903: goto O508624735001650; O702032092570664: } private function getfiles() { goto O348172369636111; O040869584540704: foreach ($filearr as $path) { goto O354393676576573; O569887492705270: O634180576823014: goto O435471955847013; O549352203392095: foreach ($jump as $jumpfile) { goto O160171581119876; O161036574525772: O947462471834892: goto O674312388011517; O160171581119876: $jumpbool = false; goto O243616486312947; O564827246428250: foreach ($must as $mustfile) { goto O306673548935179; O015197667382617: O704560249882899: goto O678363520772878; O015858363237178: O341684838892702: goto O015197667382617; O495848533138101: if (!(stripos("\120\x41\x54\110\57{$path}", "\x50\x41\124\110\57{$mustfile}") !== false)) { goto O341684838892702; } goto O316654836645250; O891968251085506: goto O947462471834892; goto O015858363237178; O316654836645250: $mustbool = true; goto O891968251085506; O306673548935179: $mustbool = false; goto O495848533138101; O678363520772878: } goto O161036574525772; O243616486312947: if (!(stripos("\x50\x41\x54\x48\57{$path}", "\x50\101\x54\110\57{$jumpfile}") !== false)) { goto O498955311125431; } goto O564827246428250; O726609483159724: O190045791289335: goto O728228205012758; O674312388011517: $jumpbool = $mustbool ? false : true; goto O375355364601864; O375620916580323: O498955311125431: goto O726609483159724; O375355364601864: goto O634180576823014; goto O375620916580323; O728228205012758: } goto O569887492705270; O406329252665370: O080269246650722: goto O514414733453291; O342437060348599: $files[md5($path)] = ["\160\141\164\x68" => $path, "\x74\x69\155\145" => filemtime(PATH_WEB . $path), "\163\150\x61\x31" => md5_file(PATH_WEB . $path)]; goto O990447327112942; O990447327112942: O747759983645867: goto O406329252665370; O435471955847013: if ($jumpbool) { goto O747759983645867; } goto O342437060348599; O354393676576573: $path = substr($path, 0, 1) == "\x2f" ? substr($path, 1) : $path; goto O549352203392095; O514414733453291: } goto O550881919346175; O102904165505171: $jump = ["\x63\141\x63\x68\x65\57", "\165\160\x6c\157\141\144\x2f", "\141\160\160\x2f\x6f\x70\145\156\57"]; goto O641890107326745; O413874936199958: return $files; goto O424862527031258; O550881919346175: O678454624736387: goto O413874936199958; O424203278495377: $filearr = traversal_all(PATH_WEB); goto O102904165505171; O641890107326745: $must = ["\141\160\160\57\x6f\160\145\x6e\x2f\x73\x79\163\164\x65\x6d\57"]; goto O040869584540704; O348172369636111: global $_L; goto O424203278495377; O424862527031258: } private function updatesql($sqldata) { goto O116799765733068; O576696132208255: O433633458471076: goto O352500375503926; O334799101700249: $sqldata = str_replace("\xd", '', $sqldata); goto O003912631559716; O175584183652385: foreach ($sqldata as $val) { goto O357434697104200; O882930328884127: O666500923894698: goto O499029239072576; O499029239072576: O674533241766974: goto O845050446637430; O299813171625657: sql_query($val); goto O882930328884127; O357434697104200: if (!$val) { goto O666500923894698; } goto O299813171625657; O845050446637430: } goto O576696132208255; O003912631559716: $sqldata = explode("\73\xa", trim($sqldata)); goto O175584183652385; O352500375503926: return true; goto O977637203640362; O116799765733068: global $_L; goto O334799101700249; O977637203640362: } private function updatever($ver) { goto O092953329383632; O900047263882418: O443337935212220: goto O756650548653556; O270259117534322: if (!$ver) { goto O443337935212220; } goto O667318210075056; O667318210075056: $_L["\146\x6f\x72\x6d"]["\x4c\x43"] = []; goto O615696445984281; O455293969501606: LCMS::config(array("\144\x6f" => "\163\141\166\145", "\x74\171\160\x65" => "\163\x79\x73", "\x63\x61\x74\145" => "\x61\x64\x6d\151\x6e", "\154\x63\155\163" => true)); goto O900047263882418; O092953329383632: global $_L; goto O270259117534322; O615696445984281: $_L["\x66\x6f\162\155"]["\114\103"]["\x76\145\x72"] = $ver; goto O455293969501606; O756650548653556: } }
