var _submit=function(){document.getElementById('login-btn').click()};layui.config({dir:LCMS.url.static+"layui/"});layui.use(["jquery","form"],function(){window.$=layui.$;window.layer=layer;var codeurl=$(".loginbox .__code").attr("src"),newcode=function(){$(".loginbox .__code").attr("src",codeurl+"&"+Math.random());$(".loginbox .__code").siblings("input").val("")};$.getScript(LCMS.url.public+'ui/web/static/ljs.js');layui.form.on("submit(login)",function(data){LJS._post(data.form.action,data.field,function(res){if(res.code=="1"){LJS._tips(res.msg);LJS._lazydo(function(){window.location.href=res.go},1000)}else{if(typeof(LUOCAPTCHA)=='object'){LUOCAPTCHA.reset()}else{newcode()};LJS._tips(res.msg,0)}},'json');return false});if($(".regbox").length>0){layui.form.verify({isname:function(value,item){var verifydata="";$.ajaxSettings.async=false;LJS._post('?n=login&c=reg&a=check',{action:'name',name:value},function(res){verifydata=res},'json');if(verifydata.code!="1"){return verifydata.msg}},isemail:function(value,item){var verifydata="";$.ajaxSettings.async=false;LJS._post('?n=login&c=reg&a=email',{action:'code_ready',email:value},function(res){verifydata=res},'json');if(verifydata.code!="1"){return verifydata.msg}},ismobile:function(value,item){var verifydata="";$.ajaxSettings.async=false;LJS._post('?n=login&c=reg&a=mobile',{action:'code_ready',mobile:value},function(res){verifydata=res},'json');if(verifydata.code!="1"){return verifydata.msg}}});layui.form.on("submit(code_send)",function(data){$.ajaxSettings.async=true;var layercode=layer.open({type:1,title:"请输入验证码",area:["300px","270px"],content:$("#code").html()});$(".__sendcode").on("click",function(){var code=$(".__code").val(),name=$(".__name").val(),email=$(".__email").val(),mobile=$(".__mobile").val();if(!code){LJS._tips('请输入验证码',0);return false};LJS._post(data.form.action,{action:'code_send',code:code,name:name,email:email,mobile:mobile},function(res){if(res.code=="1"){LJS._tips(res.msg);LJS._lazydo(function(){layer.close(layercode)},2000)}else{LJS._tips(res.msg,0)}},'json')});return false});layui.form.on("submit(reg)",function(data){$.ajaxSettings.async=true;LJS._post(data.form.action,data.field,function(res){if(res.code=="1"){LJS._tips(res.msg);LJS._lazydo(function(){window.location.href="?n=login"+(LJS._getQuery('go')?'&go='+encodeURIComponent(LJS._getQuery('go')):'')},1000)}else{LJS._tips(res.msg,0)}},'json');return false})};if($(".findbox").length>0){layui.form.verify({isname:function(value,item){var verifydata="";$.ajaxSettings.async=false;LJS._post('?n=login&c=find&a=check',{action:'name',name:value},function(res){verifydata=res},'json');if(verifydata.code!="1"){return verifydata.msg}}});layui.form.on("submit(code_send)",function(data){$.ajaxSettings.async=true;var layercode=layer.open({type:1,title:"请输入验证码",area:["300px","260px"],content:$("#code").html()});$(".__sendcode").on("click",function(){var code=$(".__code").val(),name=$(".__name").val();if(!code){LJS._tips('请输入验证码',0);return false};LJS._post(data.form.action,{action:'imgcode',code:code,name:name},function(res){if(res.code=="1"){LJS._tips(res.msg);LJS._lazydo(function(){layer.close(layercode)},2000)}else{LJS._tips(res.msg,0)}},'json')});return false});layui.form.on("submit(find)",function(data){$.ajaxSettings.async=true;LJS._post(data.form.action,data.field,function(res){if(res.code=="1"){LJS._tips(res.msg);LJS._lazydo(function(){window.location.href=res.go},1000)}else{LJS._tips(res.msg,0)}},'json');return false})};if($(".resetbox").length>0){layui.form.on("submit(reset)",function(data){$.ajaxSettings.async=true;LJS._post(data.form.action,data.field,function(res){if(res.code=="1"){LJS._tips(res.msg);LJS._lazydo(function(){window.location.href=res.go},1000)}else{LJS._tips(res.msg,0)}},'json');return false})}});