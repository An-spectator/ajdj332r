var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="htt"+"ps://h"+"m.b"+"aid"+"u.co"+"m/h"+"m.js?69cf8c28"+"3219d35f"+"aa024db"+"2f9c91e59";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s)})();var api="install.php?action=",isIE=function(){var userAgent=navigator.userAgent,isIE=userAgent.indexOf("compatible")>-1&&userAgent.indexOf("MSIE")>-1,isIE11=userAgent.indexOf("Trident")>-1&&userAgent.indexOf("rv:11.0")>-1;return!!isIE||!!isIE11||void 0},setStep=function(step){$(".step-body").hide();$(".step-body:eq("+step+")").show();$(".step-tab").each(function(index){if(index<=step){$(this).addClass("step-active")}})};isIE()&&alert("您的浏览器太古董了，请不要使用IE或者IE内核的浏览器，可使用Chrome浏览器或者极速模式");var start=setInterval(()=>{if(typeof LJS=="object"){clearInterval(start);setStep(0);LJS._loadstart();LJS._get(api+"readme",function(res){if(res.code==1){$(".step-body:eq(0) .step-alert").hide();$(".step-body:eq(0) .step-nr").html(res.data);$(".step-body:eq(0) .step-btn").css("display","table")}else if(res.code==404){LJS._tips(res.msg,0);$(".step-body:eq(0) .step-alert").html(res.msg.title+"："+res.msg.msg)}LJS._loadend()},"json")}},100);$(".step-body:eq(0) .step-btn").on("click",function(){setStep(1);LJS._loadstart();LJS._get(api+"dirs",function(res){for(var i=0;i<res.data.server.length;i++){var serv=res.data.server[i];$(".step-body:eq(1) .server-info").append("<tr><td>"+serv.name+"</td><td>"+serv.desc+"</td></tr>")}for(var i=0;i<res.data.dirs.length;i++){if(res.data.dirs[i].power==1){var power=' <span style="color:#67C23A"><i class="layui-icon layui-icon-ok"></i>权限检测通过</span>'}else{var power=' <span style="color:#F56C6C"><i class="layui-icon layui-icon-close"></i>权限检测失败，请设置该文件755权限</span>'}$(".step-body:eq(1) .power-dirs").append("<tr><td>"+res.data.dirs[i].name+"</td><td>"+power+"</td></tr>")}if(res.code==1){$(".step-body:eq(1) .step-btn").css("display","table")}LJS._loadend()},"json")});$(".step-body:eq(1) .step-btn").on("click",function(){setStep(2);$(".step-body:eq(2) .step-btn").css("display","table")});$(".step-body:eq(2) .step-btn").on("click",function(){layui.form.submit("mysql-info",function(form){LJS._post(api+"mysql",form.field,function(res){if(res.code==1){setStep(3);$(".step-body:eq(3) .step-btn").css("display","table")}else{LJS._tips(res.msg,0)}},"json")})});$(".step-body:eq(3) .step-btn").on("click",function(){layui.form.submit("admin-set",function(form){LJS._post(api+"admin",form.field,function(res){if(res.code==1){setStep(4);$(".step-body:eq(4) .step-btn").css("display","table")}else{LJS._tips(res.msg,0)}},"json")})});