layui.define(['jquery','layer'],function(exports){"use strict";var $=layui.jquery,layer=layui.layer,inputTags={config:{},set:function(options){var that=this;that.config=$.extend({},that.config,options);return that},on:function(events,callback){return layui.onevent.call(this,MOD_NAME,events,callback)}},thisinputTags=function(){var that=this,options=that.config;return{config:options}},MOD_NAME='inputTags',Class=function(options){var that=this;that.config=$.extend({},that.config,inputTags.config,options);that.render()};Class.prototype.config={elem:'',close:false,theme:'',break:'|',content:[]};Class.prototype.update=function(arr){var that=this,options=that.config,tags=[];options.elem.find('em').text(function(index,content){tags[index]=content});options.elem.children('input').val(tags.join(options.break))};Class.prototype.init=function(){var that=this,spans='',options=that.config,old=options.elem.children('input').val();options.content=old?old.split(options.break):[];$.each(options.content,function(index,item){spans+='<div><em>'+item+'</em><button type="button" class="close"><i class="layui-icon layui-icon-close"></i></button></div>'});options.elem.children('.lcms-form-tags-box').append(spans);that.events()};Class.prototype.render=function(){var that=this,options=that.config;options.elem=$(options.elem);that.enter()};Class.prototype.enter=function(){var that=this,spans='',options=that.config;options.elem.children('textarea').keypress(function(event){var keynum=(event.keyCode?event.keyCode:event.which);if(keynum=='13'){var $val=options.elem.children('textarea').val().trim();if(!$val)return false;if(options.content.indexOf($val)==-1){options.content.push($val);that.render();spans='<div><em>'+$val+'</em><button type="button" class="close"><i class="layui-icon layui-icon-close"></i></button></div>';options.elem.children('.lcms-form-tags-box').append(spans)}options.done&&typeof options.done==='function'&&options.done(options.content);that.update(options.content);options.elem.children('textarea').val('');return false}})};Class.prototype.events=function(){var that=this,options=that.config;options.elem.on('click','.close',function(){var Thisremov=$(this).parent('div').remove(),ThisText=$(Thisremov).find('em').text();options.content.splice($.inArray(ThisText,options.content),1);options.close&&typeof options.close==='function'&&options.close(options.content);that.update(options.content)})};inputTags.render=function(options){var inst=new Class(options);inst.init();return thisinputTags.call(inst)};exports('inputTags',inputTags)});