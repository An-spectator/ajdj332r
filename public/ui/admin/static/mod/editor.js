if(window.screen.width>=750){window.UEDITOR_HOME_URL=LCMS.url.static+'Neditor/';layui.link(LCMS.url.static+'Neditor/themes/notadd/css/neditor.css');LJS._getjs(LCMS.url.static+'Neditor/neditor.cfg.js','','1');LJS._getjs(LCMS.url.static+'Neditor/neditor.all.min.js','','1');LJS._getjs(LCMS.url.static+'Neditor/neditor.service.js','','1');LJS._getjs(LCMS.url.static+'Neditor/i18n/zh-cn/zh-cn.js','','1');LJS._getjs(LCMS.url.static+'Neditor/third-party/browser-md5-file.min.js','','1');top.lcms_editor_addimage=function(id,list){for(var i=0;i<list.length;i++){var src=list[i],alt=list[i].split('/')[5];if(LCMS.config.oss!='local'){src=LCMS.config.cdn+src;src=src.replace('../','')};UE.getEditor(id).execCommand('inserthtml','<img src="'+src+'" alt="'+alt+'" />')}};top.lcms_editor_addivideo=function(id,content){UE.getEditor(id).execCommand('inserthtml','<p class="player-iframe">'+content+'</p>')};top.lcms_editor_addvideo=function(id,file){if(LCMS.config.oss!='local'){file=LCMS.config.cdn+file;file=file.replace('../','')};UE.getEditor(id).execCommand('inserthtml','<p class="player-video"><video src="'+file+'" controls="controls" width="300" height="150"></video></p>')};top.lcms_editor_addattachment=function(id,file){var name=file.split('/')[5];var mime=name.split('.')[1];switch(mime){case'chm':var gif='chm.gif';break;case'exe':var gif='exe.gif';break;case'pdf':var gif='pdf.gif';break;case'psd':var gif='psd.gif';break;case'txt':var gif='txt.gif';break;case'rar':case'zip':case'7z':var gif='rar.gif';break;case'doc':case'docx':case'wps':var gif='doc.gif';break;case'xls':case'xlsx':case'et':var gif='xls.gif';break;case'ppt':case'pptx':case'dps':var gif='ppt.gif';break;case'mp3':case'wav':case'wma':var gif='mp3.gif';break;case'jpg':case'jpeg':case'gif':case'bmp':case'png':var gif='jpg.gif';break;case'mv':case'mp4':case'mpg':case'avi':var gif='mv.gif';break;default:var gif='default.png';break}if(LCMS.config.oss!='local'){file=LCMS.config.cdn+file;file=file.replace('../','')};UE.getEditor(id).execCommand('inserthtml','<p><img style="vertical-align:middle;margin-right:2px;" src="'+LCMS.url.static+'Neditor/dialogs/attachment/fileTypeImages/icon_'+gif+'"/><a style="color:#0066cc;" href="'+file+'" title="'+name+'">'+name+'</a></p>')};$('.lcms-form-editor').each(function(index){var that=$(this);LJS._lazydo(function(){var id='LCMSEDITOR'+index;var editor='editor'+index;that.children('script').attr('id',id);UE.registerUI('insertimage',function(editor,uiName){return new UE.ui.Button({name:uiName,title:'上传图片',onclick:function(){if($(window).width()<540){var area=['100%','100%']}else{var area=['550px','550px']};layer.open({type:2,title:'上传图片',area:area,resize:false,scrollbar:false,content:'index.php?n=upload&c=gallery&a=upload&many=1&id='+id})}})});UE.registerUI('simpleupload',function(editor,uiName){return new UE.ui.Button({name:uiName,title:'图库',onclick:function(){if($(window).width()<540){var area=['100%','100%']}else{var area=['550px','550px']};layer.open({type:2,title:'图库',area:area,resize:false,scrollbar:false,content:'index.php?n=upload&c=gallery&many=1&id='+id})}})});UE.registerUI('insertvideo',function(editor,uiName){return new UE.ui.Button({name:uiName,title:'视频',onclick:function(){if($(window).width()<540){var area=['100%','100%']}else{var area=['550px','550px']};layer.open({type:2,title:'视频',area:area,resize:false,scrollbar:false,content:'index.php?n=upload&c=gallery&a=ivideo&id='+id})}})});UE.registerUI('attachment',function(editor,uiName){return new UE.ui.Button({name:uiName,title:'附件',onclick:function(){if($(window).width()<540){var area=['100%','100%']}else{var area=['550px','550px']};layer.open({type:2,title:'上传附件',area:['300px','160px'],resize:false,scrollbar:false,content:'index.php?n=upload&c=gallery&a=attachment&id='+id})}})});editor=UE.getEditor(id,{toolbars:[['fullscreen','paragraph','fontsize','|','bold','italic','underline','strikethrough','removeformat','formatmatch','blockquote','pasteplain','|','forecolor','backcolor','insertorderedlist','insertunorderedlist','|','justifyleft','justifycenter','justifyright','justifyjustify','|','inserttable','|','link','unlink','|','imagenone','imageleft','imageright','imagecenter','|','insertimage','simpleupload','insertvideo','attachment','insertframe','|','horizontal','insertcode','|','source']],insertorderedlist:{},insertunorderedlist:{},catcherUrlPrefix:'',catcherFieldName:"files",catcherActionName:"uploadcatcher",catchRemoteImageEnable:true,paragraph:{'h2':'标题1','h3':'标题2','h4':'标题3','p':'段落'},fontsize:[10,12,14,16,18,20,24,36],zIndex:1,autoFloatEnabled:true,autoHeightEnabled:true,allowDivTransToP:false,initialFrameHeight:320,iframeCssUrl:LCMS.url.public+'ui/web/static/editor.css?'+LCMS.config.ver})},500)})}else{layui.link(LCMS.url.static+'Eleditor/layout/base.css?v=1.0.3');LJS._getjs(LCMS.url.static+'Eleditor/Eleditor.min.js','','1');$('.lcms-form-editor').each(function(index){var that=$(this);LJS._lazydo(function(){var id='LCMSEDITOR'+index;var scr=that.children('script');that.append('<div id="'+id+'" data-name="'+scr.attr('name')+'">'+scr.html()+'</div>');scr.remove();var editor=new Eleditor({el:'#'+id,toolbars:['insertText','editText','insertImage','insertLink','delete','cancel'],uploader:function(){var up=$(this);var do_upload=function(input,formData,_resolve,_reject){$.ajax({url:LCMS['url']['admin']+'?n=upload&c=index&a=img',data:formData,processData:false,contentType:false,type:'POST',dataType:"json",success:function(res){if(res.code=="1"){LJS._tips(res.msg);_resolve(res.data.src)}else{LJS._tips(res.msg,0)}return _reject(res.msg)},error:function(){LJS._tips('请求接口出现异常',0);return _reject('请求接口出现异常')},complete:function(){input.remove();up.append('<input type="file" accept="image/*" name="editorfile" style="position:absolute;left:0;top:0;width:100%;height:100%;opacity:0;">')}})};return new Promise(function(_resolve,_reject){var input=up.children('input');input.change(function(){var mime=this.files[0].type;if(mime=='image/png'||mime=='image/gif'){var formData=new FormData();formData.append('file',this.files[0]);do_upload(input,formData,_resolve,_reject)}else{lrz(this.files[0],{width:1980}).then(function(rst){do_upload(input,rst.formData,_resolve,_reject)})}})})}})},500)})}