$('.lcms-form-table').each(function(index){var AjaxAct=function(tableId,Act,defAct){switch(Act){case'close':LJS._lazydo(function(){LJS._closeframe(true)});break;case'reload':LJS._lazydo(function(){layui.table.reload(tableId)});break;case'reload-page':LJS._lazydo(function(){window.location.reload()});break;case'reload-parent':LJS._lazydo(function(){parent.window.location.reload()});break;case'reload-top':LJS._lazydo(function(){top.window.location.reload()});break;case'goback':LJS._lazydo(function(){window.location.href=document.referrer});break;default:defAct&&LJS._lazydo(function(){defAct()});break}};var Tableajax=function(tableId,url,arr){LJS._post(url,{'LC':arr},function(res){if(res.code=='1'){res.msg&&LJS._tips(res.msg);AjaxAct(tableId,res.go)}else if(res.code=='2'){res.msg&&LJS._tips(res.msg);LJS._lazydo(function(){eval(res.go)(res.data)},res.msg?0:1)}else{res.msg&&LJS._tips(res.msg,0)};layer.closeAll()})};top.LCMSUIINDEX++;var tableId='LCMSTABLE'+top.LCMSUIINDEX,data=JSON.parse($.base64.decode($(this).attr('data'))),search=$(this).prev('.lcms-form-table-toolbar-search'),urlhash=location.hash;if(urlhash){data.page=urlhash.replace('#!lcmstablepage=','')};$(this).attr({'id':tableId,'lay-filter':tableId});var mytable=layui.table.render({id:tableId,elem:'#'+tableId,url:data.url,defaultToolbar:data.defaultToolbar,totalRow:data.totalRow,toolbar:data.toolbar,page:{theme:'#409eff',curr:data.page,hash:'lcmstablepage'},limit:data.limit,limits:[20,50,100,300,500,700,1000],cols:[data.cols],even:true,escape:false});search.show();layui.table.on('toolbar('+tableId+')',function(obj){var data=$(this).data(),checkStatus=layui.table.checkStatus(obj.config.id);switch(obj.event){case'ajax':if(data.tips){layer.alert(data.tips,{title:'操作数据',area:'120px'},function(){Tableajax(tableId,data.url,checkStatus.data)})}else{Tableajax(tableId,data.url,checkStatus.data)};break;case'iframe':let area=null;if(data.area){area=data.area.split(',');if(area.length<2){area=area[0]}};LJS._iframe(data.url,$(this).html(),0,area);break;case'href':window.location.href=data.url;break}});layui.table.on('tool('+tableId+')',function(obj){var data=$(this).data();data.url=data.url.replace(/{id}/g,obj.data.id);switch(obj.event){case'ajax':if(data.tips){layer.alert(data.tips,{title:'操作数据'+(obj.data.id?' [ID:'+obj.data.id+']':''),area:'120px'},function(){Tableajax(tableId,data.url,obj.data)})}else{Tableajax(tableId,data.url,obj.data)};break;case'iframe':let area=null;if(data.area){area=data.area.split(',');if(area.length<2){area=area[0]}};LJS._iframe(data.url+'&id='+obj.data.id,$(this).html(),0,area);break;case'href':window.location.href=data.url+'&id='+obj.data.id;break}});layui.table.on('edit('+tableId+')',function(obj){LJS._post(data.url+'-save',{'LC':{'id':obj.data.id,'name':obj.field,'value':obj.value}},function(res){if(res.code=='1'){LJS._tips(res.msg)}else{LJS._tips(res.msg,0)}})});search.on('click','.LCMSTABLESEARCHRESET',function(){search[0].reset()});layui.form.on('submit(LCMSTABLESEARCH)',function(data){layui.table.reload(tableId,{where:data.field,page:{theme:'#409eff',curr:1,hash:'lcmstablepage'}});if($(this).parent('.__form').next('.__icon').css('display')=='block'){$(this).parent('.__form').fadeOut()};return false});$(this).parent('.lcms-form-table-box').on("click",".layui-form-switch",function(){var elm=$(this).prev('input');var url=elm.attr('data-url');if(url.length>0){LJS._post(url,{'LC':{'id':LJS._getQuery('id',url),'name':LJS._getQuery('name',url),'value':elm.is(':checked')?'1':'0'}},function(res){if(res.code=='1'){res.msg&&LJS._tips(res.msg);AjaxAct(tableId,res.go,function(){if(res.go){window.location.href=res.go}})}else if(res.code=='2'){res.msg&&LJS._tips(res.msg);elm.prop("checked",elm.is(':checked')?false:true);layui.form.render('checkbox');LJS._lazydo(function(){eval(res.go)(res.data)},res.msg?0:1)}else{res.msg&&LJS._tips(res.msg,0);elm.prop("checked",elm.is(':checked')?false:true);layui.form.render('checkbox')}})}});if($(this).prev('.lcms-form-table-toolbar-search').length>0){var that=$(this).prev('.lcms-form-table-toolbar-search');if(that.children('.LCMSTABLESEARCHICON').css('display')=="block"){$('body').append('<style>div[lay-id="'+tableId+'"] .layui-table-tool{height:59px}</style>')}}else{var that=$(this).next('.layui-form').children('.layui-table-tool');if(that.children('.layui-table-tool-temp').children('button').length<=0){$('body').append('<style>div[lay-id="'+tableId+'"] .layui-table-tool{padding:0;}</style>')}}});if($('.LCMSTABLESEARCHICON').length>0){$('.LCMSTABLESEARCHICON').on('click',function(){$(this).fadeOut();$(this).prev('.__form').fadeIn();$(this).parent('form').parent('.lcms-form-table-box').css({position:'initial'})})};if($('.lcms-form-table-toolbar-search .__close').length>0){$('.lcms-form-table-toolbar-search .__close').on('click',function(){$(this).parent('.__form').fadeOut();$(this).parent('.__form').parent('form').parent('.lcms-form-table-box').css({position:'relative'});$(this).parent('.__form').next('.LCMSTABLESEARCHICON').fadeIn()})};if($('.lcms-form-table-toolbar-date').length>0){$('.lcms-form-table-toolbar-date').each(function(){var input=$(this).children('input')[0];layui.laydate.render({elem:input,trigger:'click',range:true,calendar:true,theme:'#409eff'})})};