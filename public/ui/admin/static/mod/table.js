$('.lcms-form-table').each(function(index){var id='LCMSTABLE'+index,data=JSON.parse($.base64.decode($(this).attr('data'))),search=$(this).prev('.lcms-form-table-toolbar-search');$(this).attr({'id':id,'lay-filter':id});var mytable=layui.table.render({id:id,elem:'#'+id,url:data.url,defaultToolbar:data.defaultToolbar,totalRow:data.totalRow,toolbar:data.toolbar,page:data.page,limit:data.limit,limits:[20,50,100,300,500,700,1000],cols:[data.cols],});search.show();var Tableajax=function(url,arr){if(mytable.config.cols[0][0].checkbox&&(arr===undefined||arr.length==0)){LJS._tips("请选择内容！",0);layer.closeAll()}else{LJS._post(url,{'LC':arr},function(res){if(res.code=='1'){LJS._tips(res.msg);LJS._lazydo(function(){layui.table.reload(id)})}else{LJS._tips(res.msg,0)};layer.closeAll()})}};layui.table.on('toolbar('+id+')',function(obj){var data=$(this).data(),checkStatus=layui.table.checkStatus(obj.config.id);switch(obj.event){case'ajax':if(data.tips){layer.alert(data.tips,function(){Tableajax(data.url,checkStatus.data)})}else{Tableajax(data.url,checkStatus.data)};break;case'iframe':LJS._iframe(data.url,$(this).html());break;case'href':window.location.href=data.url;break}});layui.table.on('tool('+id+')',function(obj){var data=$(this).data();switch(obj.event){case'ajax':if(data.tips){layer.alert(data.tips,function(){Tableajax(data.url,obj.data)})}else{Tableajax(data.url,obj.data)};break;case'iframe':LJS._iframe(data.url+'&id='+obj.data.id,$(this).html());break;case'href':window.location.href=data.url+'&id='+obj.data.id;break}});layui.table.on('edit('+id+')',function(obj){LJS._post(data.url+'-save',{'LC':{'id':obj.data.id,'name':obj.field,'value':obj.value}},function(res){if(res.code=='1'){LJS._tips(res.msg)}else{LJS._tips(res.msg,0)}})});search.on('click','.LCMSTABLESEARCHRESET',function(){search[0].reset()});layui.form.on('submit(LCMSTABLESEARCH)',function(data){layui.table.reload(id,{where:data.field,page:{curr:1}});return false});$(this).parent('.lcms-form-table-box').on("click",".layui-form-switch",function(){var elm=$(this).prev('input');var url=elm.attr('data-url');if(url.length>0){LJS._post(url,{'LC':{'id':LJS._getQuery('id',url),'name':LJS._getQuery('name',url),'value':elm.is(':checked')?'1':'0'}},function(res){if(res.code=='1'){LJS._tips(res.msg);if(res.go){switch(res.go){case'close':LJS._lazydo(function(){LJS._closeframe(true)});break;case'reload':LJS._lazydo(function(){window.location.reload()});break;case'reload-parent':LJS._lazydo(function(){parent.window.location.reload()});break;case'reload-top':LJS._lazydo(function(){top.window.location.reload()});break;default:LJS._lazydo(function(){window.location.href=res.go});break}}}else{LJS._tips(res.msg,0);elm.prop("checked",elm.is(':checked')?false:true);layui.form.render('checkbox')}})}})});if($('.lcms-form-table-toolbar-date').length>0){$('.lcms-form-table-toolbar-date').each(function(){var input=$(this).children('input')[0];layui.laydate.render({elem:input,trigger:'click',range:true,calendar:true,theme:'#5FB878'})})};