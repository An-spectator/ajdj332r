layui.extend({inputTags:'inputTags/inputTags'}).use(['inputTags'],function(){$('.lcms-form-tags').each(function(index){top.LCMSUIINDEX++;var id='LCMSTAGS'+top.LCMSUIINDEX;var ids='LCMSTAGSSORTABLE'+top.LCMSUIINDEX;$(this).attr('id',id);$(this).children('.lcms-form-tags-box').attr('id',ids);$(this).children('textarea').show();$(this).children('.lcms-form-tags-button').show();layui.inputTags.render({elem:'#'+id});Sortable.create(document.getElementById(ids),{onUpdate:function(evt){var id=evt.srcElement.id;var val=[];$('#'+id).find('em').text(function(index,content){val[index]=content});$('#'+id).siblings('input').attr('data-value',val.join('|'))}})});$('.lcms-form-tags-button ._more').on('click',function(){var _self=$(this).parent('.lcms-form-tags-button');var tpl='<div><em>{val}</em><button type="button" class="close"><i class="layui-icon layui-icon-close"></i></button></div>';var data=_self.siblings('input').attr('data-value');layer.prompt({title:'请输入内容，标签以 | 分割',formType:2},function(tags,index){tags=tags.split('|');var vals=[];for(var i=0;i<tags.length;i++){if(tags[i]){_self.siblings('.lcms-form-tags-box').append(LJS._tpl(tpl,{val:tags[i]}));vals[i]=tags[i]}};if(vals){vals=vals.join('|');if(data){vals='|'+vals}_self.siblings('input').attr('data-value',data+vals)};layer.close(index)})});$('.lcms-form-tags-button ._delall').on('click',function(){var _self=$(this).parent('.lcms-form-tags-button');var tips=layer.alert("确认清空所有标签？",function(){_self.siblings('.lcms-form-tags-box').html('');_self.siblings('input').attr('data-value','');layer.close(tips)})})});